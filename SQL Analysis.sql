CREATE DATABASE BUDGET_ANALYSIS;
USE BUDGET_ANALYSIS;

SELECT * FROM CLEANED_DATA;

-- 1. TOTAL BUDGET FOR THE YEAR 2023-2024
SELECT ROUND(SUM(`Budget Estimates2023-2024 Total`),2) AS TOTAL_BUDGET_FY_2023_2024
FROM CLEANED_DATA;

-- 2. TOP 5 SCHEMES BY TOTAL ALLOCATION 2023-24
SELECT SCHEME, `MINISTRY/DEPARTMENT`, `Budget Estimates2023-2024 Total`
FROM CLEANED_DATA
ORDER BY  `Budget Estimates2023-2024 Total`  DESC
LIMIT 5;

-- 3. TOTAL BUDGET ALLOCATED TO HEALTH
SELECT `MINISTRY/DEPARTMENT`, SUM(`Budget Estimates2023-2024 Total`) AS TOTAL_BUDGET
FROM CLEANED_DATA
WHERE `MINISTRY/DEPARTMENT` LIKE '%HEALTH%'
GROUP BY `MINISTRY/DEPARTMENT`;

SELECT `MINISTRY/DEPARTMENT`, SUM(`Budget Estimates2023-2024 Total`) AS TOTAL_BUDGET
FROM CLEANED_DATA
WHERE `MINISTRY/DEPARTMENT` LIKE '%EDUCATION%'
GROUP BY `MINISTRY/DEPARTMENT`;

-- 4. AVERAGE BUDGET ALLOCATION PER SCHEME
SELECT SCHEME, ROUND((`ACTUALS 2021-2022 TOTAL`+ `REVISED ESTIMATES2022-2023 TOTAL`+`BUDGET ESTIMATES2023-2024 TOTAL`)/3,2) AS AVG_ALLOCATION
FROM CLEANED_DATA
ORDER BY AVG_ALLOCATION DESC
LIMIT 10;

-- 5. TOTAL BUDGET TREND FY 2021-2022, 2022-2023, 2023-2024
SELECT ROUND(SUM(`ACTUALS 2021-2022 TOTAL`)) AS TOTAL_2021_22,
ROUND(SUM(`REVISED ESTIMATES2022-2023 TOTAL`)) AS TOTAL_2022_23,
ROUND(SUM(`BUDGET ESTIMATES2023-2024 TOTAL`)) AS TOTAL_2023_24
FROM CLEANED_DATA;

-- 6. BUDGET GROWTH FROM 2022-23 TO 2023-2024
SELECT (SUM(`BUDGET ESTIMATES2023-2024 TOTAL`)- SUM(`REVISED ESTIMATES2022-2023 TOTAL`)) AS INCREASE_IN_BUDGET,
ROUND((SUM(`BUDGET ESTIMATES2023-2024 TOTAL`)- SUM(`REVISED ESTIMATES2022-2023 TOTAL`))* 100.0/SUM(`REVISED ESTIMATES2022-2023 TOTAL`),2) AS GROWTH_PERCENT
FROM CLEANED_DATA;
SELECT SUM(`BUDGET ESTIMATES2023-2024 TOTAL`), SUM(`REVISED ESTIMATES2022-2023 TOTAL`) FROM CLEANED_DATA;

-- 7. COUNT OF SCHEMES PER MINISTRY
SELECT `MINISTRY/DEPARTMENT`, COUNT(*) AS NO_OF_SCHEMES
FROM CLEANED_DATA
GROUP BY `MINISTRY/DEPARTMENT`
ORDER BY NO_OF_SCHEMES DESC;

-- 8. SCHEMES WITH ZERO CAPITAL ALLOCATION
SELECT SCHEME, `BUDGET ESTIMATES2023-2024 CAPITAL`
FROM CLEANED_DATA
WHERE `BUDGET ESTIMATES2023-2024 TOTAL` = 0


